---
title: |
  Analysis of Associations Between Specific Satisfactions and \
  Perceived Mental Health
author: |
  Nevena Ciganovic, Abdur Imtiyas, Chun Kit Lo,\
  Lucas Noritomi-Hartwig, Keshav Worathur
date: '2022-08-01'
output: pdf_document
header-includes: 
  \usepackage{placeins}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

\

\begin{center}

\textbf{University of Toronto}

STA258H5 S - Statistics with Applied Probability
\end{center}

\newpage

```{r Library Call, include = FALSE, warning = FALSE, message = FALSE}
# Load the libraries that we need to use for our statistical analysis
library(tinytex)
library(knitr)
library(tidyverse)
library(janitor)
library(mosaic)
library(patchwork)
library(kableExtra)
```

```{r Read Data into R, message = FALSE, warning = FALSE, include = FALSE}
# Reading Data into R

# We first start by reading a data file into R.
CCHS <- read_csv("CCHS.csv")
```

```{r Converst Character to Numeric, inlcude = FALSE, warning = FALSE, echo = FALSE}
# Convert Character Variable Columns to Numeric Variables
CCHS.Num <- CCHS %>% mutate_if(is.character, as.numeric)
```

```{r Filter, include = FALSE}
## Filtering by 
## Whether or Not Attending School/College/University (1 = Yes, 2 = No)
## Age Range (2 = 15-17, 3 = 18-19, 4 = 20-24, 5 = 25-29)
CCHS.2 <- CCHS.Num %>% filter((MAC_015 == 1 | MAC_015 == 2), (dhhgage > 1 & dhhgage <= 5))

## Filtering out N/A
CCHS.2 <- CCHS.2 %>% drop_na(GEN_015, SWL_015, SWL_020, SWL_025, SWL_035, SWL_040, incdghh, DHH_SEX)
```

```{r Re-level Variables, include = FALSE}
# Re-categorize levels

# Positive Mental Health: 
# Yes as Excellent, Very Good, Good; No as Fair or Poor
# Sense of Belonging:
# Strong as Very Strong, or Somewhat Strong; No as Somewhat Weak or Very Weak 
CCHS.2 <- CCHS.2 %>% 
  mutate(Perceived.Mental.Health = case_when(GEN_015 <= 3 ~ "Positive", 
                                            GEN_015 >= 4 ~ "Negative"),
         Gender = case_when(DHH_SEX == 1 ~ "Male", 
                            DHH_SEX == 2 ~ "Female"),
         
         Housing.Satisfaction = case_when(SWL_040 <= 2 ~ "Satisfied",
                                          SWL_040 == 3 ~ "Neutral",
                                          SWL_040 >= 4 ~ "Dissatisfied"),
         Total.Household.Income = case_when(incdghh <= 2 ~ "$39,999 or less",
                                     incdghh == 3 | incdghh == 4 ~ "$40,000 to $79,999",
                                     incdghh == 5 ~ "$80,000 or more"),
         
         Satisfaction.with.Friends = case_when(SWL_035 <= 2 ~ "Satisfied",
                                                  SWL_035 == 3 ~ "Neutral", 
                                               SWL_035 >= 4 ~ "Dissatisfied"),
         
         Satisfaction.with.Oneself = case_when(SWL_020 <=2 ~ "Satisfied",
                                     SWL_020 <= 3  ~ "Neutral",
                                     SWL_020 <= 5 ~ "Dissatisfied"),
         
         Body.Image = case_when(SWL_025 <=2 ~ "Satisfied",
                                SWL_025 == 3 ~ "Neutral",
                                SWL_025 == 4 | SWL_025 == 5 ~ "Dissatisfied"),
         
         Financial.Situation = case_when(SWL_015 <= 2 ~ "Satisfied",
                                          SWL_015 == 3 ~ "Neutral",
                                          SWL_015 >= 4 ~ "Dissatisfied"))

Satisfaction.with.Friends.Levels <- c("Satisfied", 
                                      "Neutral", 
                                      "Dissatisfied")

Mental.Health.Levels <- c("Positive", 
                          "Negative")

CCHS.2 <- CCHS.2 %>% mutate(Satisfaction_with_Friends = factor(Satisfaction.with.Friends, 
                                                               levels = Satisfaction.with.Friends.Levels))

CCHS.2 <- CCHS.2 %>% mutate(Mental_Health = factor(Perceived.Mental.Health,
                                                   levels = Mental.Health.Levels))
```

```{r, results='asis', eval=(opts_knit$get('rmarkdown.pandoc.to') == 'latex'), echo = FALSE}
# cat('\\pagebreak')
```

# Abstract

In recent years, mental health has become an emerging topic with considerable efforts being dedicated to improving people’s mental health. Canadian studies from the past few years have been conducted focusing on external factors and their negative impacts on mental health. Our study investigates the relationships between different types of satisfaction in the lives of youth (15-29 years of age), and perceived mental health. The purpose of using the Canadian Community Health Survey (CCHS) data from 2017-2018 in our investigation is to utilize the most accurate, secure, and reliable data concerning the interested Canadian youth which further reinforces the statistical inferences made in our investigation. Our research focuses on perceived mental health and its association with satisfaction with housing, relationships with friends, oneself, body image, and financial situation. The results of our investigation reveal that measures of satisfaction in one’s life appear to have an association with one's perceived mental health. Introducing the demographic variables (gender and total household income) to the investigation showed that certain socio-demographic groups are inclined to have a stronger association between satisfaction and perceived mental health.
\

# Introduction

This report summarizes the statistical investigation of variables measuring life satisfaction and perception of mental health among Canadian youth. The objective of the investigation is to determine if satisfaction with different aspects of life can predict positive mental health in Canadian youth. The findings of this
investigation are useful to organizations responsible for promoting positive mental health among youth. 

The Canadian Community Health Survey (CCHS) data set was used to identify five variables measuring aspects of life satisfaction. The CCHS had a reference period from 2017 to 2018, and interviews were conducted in ten provinces and three territories. The subjects under study were Canadians aged 15 to 29 years old, representing the youth age group.  

The selected subjects of age category 15-17 were chosen from a list of beneficiaries of the Canadian Child Benefit. To obtain a sample of subjects aged 18-29, the CCHS used a two-stage sampling process. First, households were sampled from an area frame used by the Canadian Labor Force Survey. From each sampled household, a single member was selected with varying probability factoring in age and household composition. Data was collected by conducting in-person and over-the-phone interviews assisted by computers.

To prepare the CCHS data for analysis, the research team filtered for cases falling within the youth age range who had answered either “yes” or “no” to attending an education institution. Missing values and answer categories of “don’t know”, “valid skip”, “not stated”, and “valid refusal” were dropped from the analysis. 

\

## Aggregation of Variables of Interest:

### Response Variable
| Name | Code | Measurement | Composition |
| :--- | :--- | :---        | :---        |
| Perceived Mental Health \newline (Response) | GEN_015 | Positive \newline \newline \newline Negative | “Excellent”, “Very good”, “Good” \newline \newline “Fair”, “Poor”|

\newpage

### Explanatory Variables
| Name | Code | Measurement | Composition |
| :--- | :--- | :---        | :---        |
| Satisfaction - financial situation, \newline \newline Satisfaction - with oneself, \newline \newline Satisfaction - body image, \newline \newline Satisfaction - relationships with friends, \newline \newline Satisfaction - housing | SWL_015 \newline \newline \newline SWL_020 \newline \newline \newline SWL_025 \newline \newline \newline SWL_035 \newline \newline \newline \newline SWL_040 | \newline \newline Satisfied \newline \newline \newline \newline Neutral \newline \newline \newline \newline Dissatisfied | \newline \newline “Very Satisfied”, "Satisfied” \newline \newline \newline “Neither satisfied nor dissatisfied” \newline \newline \newline “Dissatisfied”, “Very dissatisfied” |

### Demographic Variables
| Name | Code | Measurement | Composition |
| :--- | :--- | :---        | :---        |
| Gender | DHH_SEX | Male (1) \newline \newline Female (2) | \newline No aggregation \newline \newline \newline |
| Total Household Income \newline (Derived from INC_021) | incdghh | $39,999 or less \newline \newline \newline \newline $40,000 to $79,999 \newline \newline \newline $80,000 or more | “No income or less than $20,000”, “$20,000 to $39,999” \newline \newline “$40,000 to $59,999”, “$60,000 to $79,999” \newline \newline “$80,000 or more”  |

## Statistical Research Questions

<!-- Lucas's Question -->
1. Does there exist an association between satisfaction with housing and perceived mental health; moreover, does it change (positively or negatively) across various levels of total household income? 

<!-- Keshav's Question -->
2. Does there exist an association between satisfaction with relationships with friends and perceived mental health, and does vary by gender?

<!-- Jacky's Question -->
3. Does there exist an association between satisfaction with oneself and perceived mental health; furthermore, does it vary by gender?

<!-- Nevena's Question -->
4. Does there exist an association between satisfaction with body image and perceived mental health; moreover, does it vary by gender? 

<!-- Abdur's Question -->
5. Does there exist an association between satisfaction with financial situation and perceived mental health; also, does it change (positively or negatively) across various levels of total household income? 

\newpage

# Statistical Analysis
<!-- Lucas -->
## Satisfaction with Housing, Total Household Income, and Perceived Mental Health

To begin, we investigate any relationship between positive perceived mental health and solely the explanatory variable: satisfaction with housing.

First we will examine the contingency table of the two aforementioned variables based on the CCHS data set.

```{r, results='asis', eval=(opts_knit$get('rmarkdown.pandoc.to') == 'latex'), echo = FALSE}
# cat('\\pagebreak')
```

```{r TwoWay Table using Different R Packages, include = TRUE, echo = FALSE}

# Two-way Table using {janitor} package
# data frame
CCHS.2 %>%                                  
  # cross-tabulate counts of two columns
  tabyl(Housing.Satisfaction, Perceived.Mental.Health) %>%            
  # add a total row, add a total column
  adorn_totals(where = c("row", "col")) %>% 
  # convert to proportions with row denominator
  adorn_percentages(denominator = "row") %>% 
  # convert proportions to percents
  adorn_pct_formatting() %>%  
  # display as: "count (percent)"
  adorn_ns(position = "front") %>% 
  # adjust titles
  adorn_title(                                
    row_name = "Satisfaction with Housing",
    col_name = "Perceived Mental Health") %>%
  # print elegant results for interactive analysis or for sharing in a report
  # e.g., with knitr::kable()
  # knitr::kable()
  knitr::kable(CCHS.2, format = "latex", longtable = FALSE, caption = 'Contingency Table of Perceived Mental
  Health and Satisfaction with Housing.') %>%
    kable_styling(latex_options = "HOLD_position")

# Two-way Table using {mosaic} package
#tally(~ Sense.of.Belonging + Perceived.Mental.Health, margin = TRUE, data = CCHS.2)
#tally(~ Sense.of.Belonging + Perceived.Mental.Health, margin = TRUE, format = "percent", data = CCHS.2)
```

```{r, results='asis', eval=(opts_knit$get('rmarkdown.pandoc.to') == 'latex'), echo = FALSE}
#cat('\\pagebreak')
```

```{r TwoWayTable using Different R Packages, include = FALSE, echo = FALSE}
# Contingency Table for Mental Health and Gender

# Two-way Table using {janitor} package
# data frame
CCHS.2 %>%                                  
  # cross-tabulate counts of two columns
  tabyl(Gender, Perceived.Mental.Health) %>%            
  # add a total row, add a total column
  adorn_totals(where = c("row", "col")) %>% 
  # convert to proportions with row denominator
  adorn_percentages(denominator = "row") %>% 
  # convert proportions to percents
  adorn_pct_formatting() %>%  
  # display as: "count (percent)"
  adorn_ns(position = "front") %>% 
  # adjust titles
  adorn_title(                                
    row_name = "Gender",
    col_name = "Positive Mental Health") %>%
  # print elegant results for interactive analysis or for sharing in a report
  # e.g., with knitr::kable()
  knitr::kable()

# Two-way Table using {mosaic} package
#tally(~ Gender + Perceived.Mental.Health, margin = TRUE, data = CCHS.2)
#tally(~ Gender + Perceived.Mental.Health, margin = TRUE, format = "percent", data = CCHS.2)
```

```{r, results='asis', eval=(opts_knit$get('rmarkdown.pandoc.to') == 'latex'), echo = FALSE}
# cat('\\pagebreak')
```

Immediately, a trend is recognized where satisfaction with housing correlates with a positive perception of mental health. In terms of conditional probabilities, as satisfaction with housing increases, respondents are more likely to report a positive perceived mental health. Those who are "Satisfied" have a probability of 92.9% to report a positive perceived mental health, the only group with a higher positive response than the overall average (91.7%).

```{r Bar Plot of Data, include = TRUE, echo = FALSE, fig.height=4, fig.width=7,fig.cap="Clustered Bar Chart of Perceived Mental Health vs. Satisfaction - Housing."}

# Bar Plots of Positive Mental Health and Sense of Belonging [Sat. w/ Housing]
denoms <- c(298, 298, 454, 454, 6071, 6071)
bar.plot1 = ggplot(CCHS.2, aes(x = factor(Housing.Satisfaction), fill = factor(Perceived.Mental.Health))) 
bar.plot1 = bar.plot1 + geom_bar(position = "dodge", aes(y = (..count..)/denoms))
bar.plot1 = bar.plot1 + labs(fill = "Perceived Mental Health")
bar.plot1 = bar.plot1 + xlab("Satisfaction with Housing")
bar.plot1 = bar.plot1 + ylab("Conditional Proportion")
bar.plot1 = bar.plot1 + scale_fill_manual(values = c("palegoldenrod", "powderblue"))
bar.plot1 = bar.plot1 + ggtitle("Perceived Mental Health and Satisfaction with Housing")
bar.plot1 = bar.plot1 + theme_bw()
bar.plot1 = bar.plot1 + theme(plot.title = element_text(size = 11), axis.title = element_text(size = 10), legend.title = element_text(size = 10))

# Bar Plots of Positive Mental Health and Gender [Total Household Income]
#bar.plot2 = ggplot(CCHS.2, aes(x = factor(Perceived.Mental.Health), fill = factor(Total.House.Inc))) 
#bar.plot2 = bar.plot2 + geom_bar(position = "dodge")
#bar.plot2 = bar.plot2 + labs(fill = "Total Household Income")
#bar.plot2 = bar.plot2 + xlab("Positive Mental Health") 
#bar.plot2 = bar.plot2 + ylab("Count")

bar.plot1 #+ bar.plot2 
```

Thus far, a general association between perceived mental health and Satisfaction with Housing has been identified: cases responding with an overall higher level of housing satisfaction are more likely to respond with a positive perception of their mental health. Out of all respondents, those who reported being satisfied with housing (making up roughly 88.98% of all respondents), 92.9% reported a positive perceived mental health.

Traversing downwards towards dissatisfaction in housing, respondents are less likely to perceive a positive mental health. Of respondents reporting neutral levels of satisfaction, making up roughly 6.65% of all respondents, only 84.1% of them report a positive perceived mental health.

Finally, respondents who reported the lower levels of housing satisfaction, making up 4.37% of all respondents, had the lowest rates of reporting a positive perceived mental health, only 79.9%. With the bar plot of conditional proportions, we are able to visualize the trend in the data.

We have identified what appears to be a positive association between satisfaction with housing (explanatory) and perceived mental health (response). However, we must still question how this association may change as we account of the demographic variable, total household income.
\

### Multivariate Association

After having only considered satisfaction with housing, we now analyze how the detected trend behaves as we account for total household income.

We have the contingency tables among total household income below:

```{r ThreeWay Table using janitor R Package, include = TRUE, echo = FALSE}
# data frame
CCHS.2 %>%                                  
  # cross-tabulate counts of two columns
  tabyl(Housing.Satisfaction, Perceived.Mental.Health, Total.Household.Income) %>%            
  # add a total row, add a total column
  adorn_totals(where = c("row", "col")) %>% 
  # convert to proportions with row denominator
  adorn_percentages(denominator = "row") %>% 
  # convert proportions to percents
  adorn_pct_formatting() %>%  
  # display as: "count (percent)"
  adorn_ns(position = "front") %>% 
  # adjust titles
  adorn_title(                                
    row_name = "Satisfaction with Housing",
    col_name = "Perceived Mental Health") %>%
  # print elegant results for interactive analysis or for sharing in a report
  # e.g., with knitr::kable()
  # knitr::kable()
  knitr:: kable(caption = 'Three-Way Contingency Table of Perceived Mental Health and Satisfaction with Housing by Total Household Income. ') %>%
    kable_styling (latex_options = "HOLD_position") # %>%
      #footnote(general = "The top table pertains to the \"$39,999 or less\"
      #group, the middle pertains to the \"$40,000 to $79,999\", \
      #and the bottom pertains to the \"$80,000 or more\" group")
```

\textit{Note:} The top table pertains to the "$39,999 or less" group, the middle table pertains to the "$40,000 to $79,999" group, and the bottom table pertains to the "$80,000 or more" group.

We analyze for any multivariate association by considering the above as multiple bivariate associations, separated by income. Across all income levels, we notice the same trend as was found in the bivariate analysis, as well as the overall probability of positive perceived mental health response being surpassed by only those with high levels of housing satisfaction.

Specifically, in the lower income group, as satisfaction with housing increases, we see the conditional probability of responding with a positive mental health increase from 76.6% by those dissatisfied with housing, to 85.3% by those who are neutral, up to 90.1% by those satisfied.

For respondents within $40,000 an $79,999 in total household income, those dissatisfied showed an 86.3% probability of reporting positive perceived mental health (nearly a 10% increase compared to those in the lower income levels with similar satisfaction). This increase does not follow for those of neutral satisfaction, an 83.0% probability (2.3% lower). However the increase does follow for those of higher satisfaction, an increase of 3.2%, to 93.3%.

A similar behaviour is found in the higher income group: as satisfaction increases, so does the conditional probability of reporting a positive perceived mental health. Now, across these levels of income, some change in the proportion of those reporting a positive perceived mental health for different satisfactions is noticed, however further clarity is required.

Thus, we again consult the bar plot, now among total household income:

```{r, results='asis', eval=(opts_knit$get('rmarkdown.pandoc.to') == 'latex'), echo = FALSE}
# cat('\\pagebreak')
```

```{r ThreeWay Table using mosaic R Package, include = FALSE, echo = FALSE}
# tally(~ Perceived.Mental.Health | Sense.of.Belonging + Gender, 
 #     margin = TRUE, data = CCHS.2)
#tally(~ Perceived.Mental.Health | Sense.of.Belonging + Gender, 
 #     margin = TRUE, format = "percent", data = CCHS.2)
```

```{r Multivariate Bar Plots, include=TRUE, echo = FALSE, fig.height=4, fig.width=7, fig.cap="Clustered Bar Charts of Perceived Mental Health vs. Satisfaction - Housing by Income. Letter notation: 'D': \"Dissatisfied\", 'N': \"Neutral\", 'S': \"Satisfied\""}
CCHS.2 <- CCHS.2 %>% 
  mutate(Housing.Satisfaction = case_when(SWL_040 <= 2 ~ "S",
                                          SWL_040 == 3 ~ "N",
                                          SWL_040 >= 4 ~ "D"))

# Side-by-side Bar Plots: Multivariate Association
denoms <- c(128, 128, 150, 150, 1313, 1313, 95, 95, 147, 147, 1571, 1571, 75, 75, 157, 157, 3187, 3187)
bar.plot = ggplot(CCHS.2, aes(x = factor(Housing.Satisfaction), fill = factor(Perceived.Mental.Health))) 
bar.plot = bar.plot + geom_bar(position = "dodge", aes(y = (..count..)/denoms))
bar.plot = bar.plot + labs(fill = "Perceived Mental Health")
bar.plot = bar.plot + xlab("Satisfaction with Housing")
bar.plot = bar.plot + ylab("Conditional Proportion")
bar.plot = bar.plot + scale_fill_manual(values = c("palegoldenrod", "powderblue"))
bar.plot = bar.plot + ggtitle("Perceived Mental Health and Satisfaction by Income")
bar.plot = bar.plot + facet_wrap(~factor(Total.Household.Income), scales = "free_x")
bar.plot = bar.plot + theme_bw()
bar.plot = bar.plot + theme(plot.title = element_text(size = 11), axis.title = element_text(size = 10), legend.title = element_text(size = 10))
bar.plot
```

\

From the bar plots among the demographic variable, the following observations can be made:

As total household income decreases, the proportion of respondents who are dissatisfied with their housing situation increases. This observation is more clear when comparing only the rightmost and leftmost bar plots. Those of lower levels of total household income are more likely to report a dissatisfaction with housing, and by consequence, a negative perceived mental health standing.

Inversely, as we observe the respondents with higher levels of total household income, we see that the proportion, in regards to housing satisfaction, shifts back somewhat to those who are neutral, and greatly to those who are satisfied. This results in the respondents with higher levels of total household income being more likely to report a positive perception of mental health.

With increases in total household income, the distribution of housing satisfaction greatly increases, improving the probability of positive perceived mental health reports. The overall probability of reporting positive perceived mental health across lower, middle, and higher levels of income is 88.6%, 92.1%, and 93.0%, respectively.

Ultimately, we have found evidence to suggest that satisfaction with housing shares a strong positive association with positive perceived mental health. Accounting for the demographic of total household income highlights how responses regarding satisfaction with housing change. With this we detect variations in the responses of satisfaction, which in turn affects reports of perceived mental health.

<!-- /Lucas -->

\

<!-- Keshav -->

## Satisfaction with Relationships with Friends, Gender, and Perceived Mental Health

```{r two-var-bar-plot, echo=FALSE, fig.height=4, fig.width=7,fig.cap="Clustered Bar Chart of Perceived Mental Health vs. Satisfaction - Relationships with Friends." }
denoms <- c(6262, 6262, 328, 328, 190, 190)
bar.plot = ggplot(data = CCHS.2, aes(x = Satisfaction_with_Friends, fill = factor(Mental_Health)))
bar.plot = bar.plot + geom_bar(position = "dodge", 
                               aes(y =(..count..)/ denoms))
bar.plot = bar.plot + ggtitle("Perceived Mental Health vs. Satisfaction - Relationships with Friends")
bar.plot = bar.plot + theme(axis.text.x=element_text(angle=90, hjust=1))
bar.plot = bar.plot + xlab("Satisfaction - Relationships with Friends")  
bar.plot = bar.plot + ylab("Conditional Proportion")
bar.plot = bar.plot + labs(fill="Perceived Mental Health")
bar.plot = bar.plot + theme_bw()
bar.plot1 = bar.plot1 + theme(plot.title = element_text(size = 11), axis.title = element_text(size = 10), legend.title = element_text(size = 10))
# Colour
bar.plot = bar.plot + scale_fill_manual(values = c("mediumaquamarine", "rosybrown1"))
bar.plot
```

Overall, 91.7% of respondents held a positive perception of their mental health. Similarly, when grouping by satisfaction with friendships, a majority of respondents in all three groups indicated a positive perception of their mental health. However, respondents who were dissatisfied with their friendships were most likely to hold a negative perception of their mental health.

```{r two-way-table, echo=FALSE}
CCHS.2 %>%                                    # data frame
  tabyl(Satisfaction_with_Friends, Mental_Health) %>%            # cross-tabulate counts of two columns
  adorn_totals(where = c("row", "col")) %>%   # add a total row, add a total column
  adorn_percentages(denominator = "row") %>%  # convert to proportions with row denominator
  adorn_pct_formatting() %>%                  # convert proportions to percents
  adorn_ns(position = "front") %>%            # display as: "count (percent)"
  adorn_title(                                # adjust titles
    row_name = "Satisfaction - Relationships with Friends",
    col_name = "Perceived Mental Health") %>%
knitr::kable( CCHS.2, format = "latex",longtable = FALSE, caption = 'Contingency Table of Perceived Mental Health and Satisfaction - Relationships with Friends.') %>%
  kable_styling(latex_options = "HOLD_position")
```

Note that 42.9% of respondents who were dissatisfied with their friendships held a negative perception of their mental health, compared to only 6.6% of respondents who were satisfied with their friendships. Controlling for satisfaction with friendships, 8.3% of respondents held a negative perception of their mental health. The distribution of perceived mental health differs for each level of satisfaction with friendships. In conclusion, there appears to be an association between perceived mental health and satisfaction with friendships.

```{r three-var-bar-plot, echo=FALSE, fig.height=4, fig.width=7, fig.cap="Clustered Bar Chart of Perceived Mental Health vs. Sense of Belonging to a Local Community by Gender."}
denoms <- c(3187, 3187, 194, 194, 108, 108, 3075, 3075, 134, 134, 82, 82)
bar.plot = ggplot(CCHS.2, aes(x = Satisfaction_with_Friends, fill = factor(Mental_Health)))
bar.plot = bar.plot + geom_bar(position = "dodge", 
                               aes(y =(..count..)/denoms))
bar.plot = bar.plot + labs(fill = "Perceived Mental Health")
bar.plot = bar.plot + xlab("Satisfaction - Relationships with Friends") 
bar.plot = bar.plot + ylab("Conditional Proportion")
bar.plot = bar.plot + ggtitle("Perceived Mental Health vs. Satisfaction - Relationships with Friends \n by Gender")
bar.plot = bar.plot + facet_wrap(~Gender, scales = "free_x")
bar.plot = bar.plot + theme_bw()
bar.plot1 = bar.plot1 + theme(plot.title = element_text(size = 11), axis.title = element_text(size = 10), legend.title = element_text(size = 10))
# Colour
bar.plot = bar.plot + scale_fill_manual(values = c("mediumaquamarine", "rosybrown1"))
bar.plot
```

In both the female and male groups, as satisfaction with friendships increases, rates of positive mental health perception increases (a positive correlation). In the "satisfied" and "neutral" categories, males were more likely than females to indicate positive mental health perception. However, in the "dissatisfied" category, females were more likely than males to indicate positive mental health perception. 

```{r three-way-table, echo=FALSE}
CCHS.2 %>%                                    # data frame
  tabyl(Satisfaction_with_Friends, Mental_Health, Gender) %>%            # cross-tabulate counts of two columns
  adorn_totals(where = c("row", "col")) %>%   # add a total row, add a total column
  adorn_percentages(denominator = "row") %>%  # convert to proportions with row denominator
  adorn_pct_formatting() %>%                  # convert proportions to percents
  adorn_ns(position = "front") %>%            # display as: "count (percent)"
  adorn_title(                                # adjust titles
    row_name = "Satisfaction - Relationships with Friends",
    col_name = "Perceived Mental Health") %>%
knitr::kable(caption = 'Partial Two-Way Table of Perceived Mental Health and Satisfaction - Relationships with Friends, by Gender.') %>%
  kable_styling(latex_options = "HOLD_position") %>%
    footnote(general = "The top table contains female group data, the bottom table contains male group data")
```

Among females, 91.6% of those satisfied with their friendships held a positive perception of their mental health, compared to 76.9% of those neither dissatisfied nor satisfied with their friendships and only 61.5% of those dissatisfied with their friendships. Controlling for satisfaction with friendships, 89.8% of females held a positive perception of their mental health. \

Among males, 95.3% of those satisfied with their friendships held a positive perception of their mental health, compared to 83.2% of those neither dissatisfied nor satisfied with their friendships and only 51.2% of those dissatisfied with their friendships. Controlling for satisfaction with friendships, 93.7% of males held a positive perception of their mental health. \

Therefore, the distribution of perceived mental health differs by gender, for each level of satisfaction with friendships. There is a positive correlation between satisfaction with friends and perceived mental health for both the female and male groups. In conclusion, there appears to be an association between perceived mental health, satisfaction with friendships, and gender.

<!-- /Keshav -->

\

<!-- Jacky -->

## Satisfaction with Oneself, Gender, and Pereived Mental Health

```{r , fig.height=4, fig.width=7, fig.cap="Clustered Bar Chart of Perceived Mental Health vs. Satisfaction with Oneself"}

# Bar Plots of Positive Mental Health and Satisfaction with Oneself
denoms <- c(287, 287, 575, 575, 5961, 5961)
bar.plot1 = ggplot(CCHS.2, aes(x = factor(Satisfaction.with.Oneself), fill = factor(Perceived.Mental.Health))) 
bar.plot1 = bar.plot1 + geom_bar(position = "dodge", aes(y =(..count..)/denoms))
bar.plot1 = bar.plot1 + ggtitle("Perceived Mental Health vs. Satisfaction - with Onself")
bar.plot1 = bar.plot1 + labs(fill = "Perceived Mental Health")
bar.plot1 = bar.plot1 + xlab("Satisfaction with Oneself") 
bar.plot1 = bar.plot1 + ylab("Conditional Proportion")
bar.plot1 = bar.plot1 + theme_bw()
bar.plot1 = bar.plot1 + theme(plot.title = element_text(size = 11), axis.title = element_text(size = 10), legend.title = element_text(size = 10))
bar.plot1 = bar.plot1 + scale_fill_manual(values = c("darkolivegreen3", "lightsalmon"))
bar.plot1
```

Overall, there is a trend in which respondents are more likely to have a positive mental health perception as their satisfaction with oneself increases. A trend also appears as the number of respondents who had a negative perception increases as their satisfaction with oneself decreases. Respondents who had a positive mental health perception consists of 91.7% of the population, and respondents who were satisfied counts for the highest percentage (95.9%). Conversely, respondents who were dissatisfied were more likely to hold a negative perception of their mental health, as they consist of the 54.4% of the population who hold a negative perception comparing to 29.2% and 4.1% across the other two levels of satisfaction.

```{r}
# Two-way Table using {janitor} package
# data frame
CCHS.2 %>%                                  
  # cross-tabulate counts of two columns
  tabyl(Satisfaction.with.Oneself, Perceived.Mental.Health) %>%            
  # add a total row, add a total column
  adorn_totals(where = c("row", "col")) %>% 
  # convert to proportions with row denominator
  adorn_percentages(denominator = "row") %>% 
  # convert proportions to percents
  adorn_pct_formatting() %>%  
  # display as: "count (percent)"
  adorn_ns(position = "front") %>% 
  # adjust titles
  adorn_title(                                
    row_name = "Satisfaction with Oneself",
    col_name = "Perceived Mental Health") %>%
  # print elegant results for interactive analysis or for sharing in a report
  # e.g., with knitr::kable() %>%
  knitr::kable(CCHS.2, format = "latex", longtable = FALSE, caption = 'Contingency Table of Perceived Mental Health and Satisfaction with Oneself') %>% 
  kable_styling(latex_options = "HOLD_position")

```

```{r three-var-bar-plot-2, include = TRUE, echo = FALSE, fig.height=4, fig.width=7, fig.cap="Clustered Bar Chart of Perceived Mental Health vs. Satisfaction with Oneself, by Gender"}
denoms <- c(160, 160, 357, 357, 2993, 2993, 127, 127, 218, 218, 2968, 2968)
# Side-by-side Bar Plots: Multivariate Association
bar.plot = ggplot(CCHS.2, aes(x = Satisfaction.with.Oneself, fill = factor(Perceived.Mental.Health))) 
bar.plot = bar.plot + geom_bar(position = "dodge", aes(y =(..count..)/denoms))
bar.plot = bar.plot + labs(fill = "Perceived Mental Health")
bar.plot = bar.plot + xlab("Satisfaction with Oneself")
bar.plot = bar.plot + ylab("Conditional Proportion")
bar.plot = bar.plot + ggtitle("Perceived Mental Health vs. Satisfaction with Oneself by Gender")
bar.plot = bar.plot + facet_wrap(~factor(Gender), scales = "free_x")
bar.plot = bar.plot + theme_bw()
bar.plot = bar.plot + theme(plot.title = element_text(size = 11), axis.title = element_text(size = 10), legend.title = element_text(size = 10))
bar.plot = bar.plot + scale_fill_manual(values = c("darkolivegreen3", "lightsalmon"))
bar.plot
```

Overall, for both male and female groups, as respondents' satisfaction with oneself increases, the number of respondents who had positive perception of mental health increases. An opposite trend appears in which as satisfaction with oneself decreases, the number of respondents with negative perception of mental health increases. Comparing male and female, male respondents had higher percentages of a positive mental health perception across all three levels of satisfaction with oneself. Therefore, female respondents are more likely to hold a negative perception of mental health.

```{r }
# data frame
CCHS.2 %>%                                  
  # cross-tabulate counts of two columns
  tabyl(Satisfaction.with.Oneself, Perceived.Mental.Health, Gender) %>%            
  # add a total row, add a total column
  adorn_totals(where = c("row", "col")) %>% 
  # convert to proportions with row denominator
  adorn_percentages(denominator = "row") %>% 
  # convert proportions to percents
  adorn_pct_formatting() %>%  
  # display as: "count (percent)"
  adorn_ns(position = "front") %>% 
  # adjust titles
  adorn_title(                                
    row_name = "Satisfaction with Oneself",
    col_name = "Perceived Mental Health") %>%
  # print elegant results for interactive analysis or for sharing in a report
  # e.g., with knitr::kable()
  knitr::kable(CCHS.2, format = "latex", longtable = FALSE, caption = 'Contingency Table of Perceived Mental Health and Satisfaction with Oneself by Gender') %>% 
  kable_styling(latex_options = "HOLD_position")
```

To conclude, there is an association between satisfaction with oneself and perceived mental health across gender. The trends discovered in the association between satisfaction with oneself and perceived mental health is consistent with the association after including gender. Males are more likely to have a positive mental health perception than females in all three levels of satisfaction (satisfied, neutral and dissatisfied).

<!-- /Jacky -->

\newpage

<!-- Nevena -->

## Satisfaction with Body Image, Gender, and Perceived Mental Health

### Association Between Perceived Mental Health and Satisfaction with Body Image

To begin this analysis, we will investigate whether an association exists between perceived mental health and satisfaction with body image. First, we will examine the bar plot of the two above-stated variables; then, we will analyze the contingency table in order to determine whether an association exists.

```{r Bar Plot of Data-N, include = TRUE, fig.height=4, fig.width=7, fig.cap="Bar Plot of Perceived Mental Health and Satisfaction with Body Image."}
# Bar Plot of Satisfaction with Body Image and Positive Mental Health
denoms <- c(712, 712, 1043, 1043, 5113, 5113)
bar.plot1 = ggplot(CCHS.2, aes(x = factor(Body.Image), fill = factor(Perceived.Mental.Health))) 
bar.plot1 = bar.plot1 + geom_bar(position = "dodge", aes(y = (..count..)/denoms))
bar.plot1 = bar.plot1 + labs(fill = "Perceived Mental Health")
bar.plot1 = bar.plot1 + xlab("Satisfaction with Body Image") 
bar.plot1 = bar.plot1 + ylab("Conditional Proportion")
bar.plot1 = bar.plot1 + scale_fill_manual(values = c("darkseagreen2", "plum1"))
bar.plot1 = bar.plot1 + ggtitle("Perceived Mental Health and Satisfaction with Body Image")
bar.plot1 = bar.plot1 + theme(plot.title = element_text(size = 11), axis.title = element_text(size = 10), legend.title = element_text(size = 10))
bar.plot1
```

Overall, the bar plot in Figure 7 shows that the majority of respondents in each level of satisfaction with body image indicated a positive perception of their mental health. The highest proportion of positive perceived mental health was among those who were satisfied with their body image and the lowest proportion was among those who were dissatisfied. In contrast, respondents who were dissatisfied with their body image had the highest proportion of negative perceived mental health, while those who were satisfied had the lowest proportion of negative perceived mental health.

```{r TwoWay Table using Different R Packages-N, include = TRUE}
# Two-way Table using {janitor} package
# data frame
CCHS.2 %>%                                  
  # cross-tabulate counts of two columns
  tabyl(Body.Image, Perceived.Mental.Health) %>%            
  # add a total row, add a total column
  adorn_totals(where = c("row", "col")) %>% 
  # convert to proportions with row denominator
  adorn_percentages(denominator = "row") %>% 
  # convert proportions to percents
  adorn_pct_formatting() %>%  
  # display as: "count (percent)"
  adorn_ns(position = "front") %>% 
  # adjust titles
  adorn_title(                                
    row_name = "Satisfation with Body Image",
    col_name = "Perceived Mental Health") %>%
  # print elegant results for interactive analysis or for sharing in a report
  # e.g., with knitr::kable()
  knitr::kable(CCHS.2, format = "latex", longtable = FALSE, caption = 'Contingency Table of Perceived Mental Health and Satisfaction with Body Image') %>%
  kable_styling(latex_options = "HOLD_position")
```

Further analyzing this trend using the contingency table, we observe that 95.0% of respondents who were satisfied with their body image held a positive perception of their mental health, compared to 88.2% who were neither satisfied nor dissatisfied and 73.3% who were dissatisfied. Controlling for satisfaction with body image, 91.7% of respondents held a positive perception of their mental health. Information regarding satisfaction with body image contributed to explaining the difference in percentage of perception of mental health. Therefore, there appears to be an association between perceived mental health and satisfaction with body image.

### Association Between Perceived Mental Health and Satisfaction by Gender

After analyzing the association between perceived mental health and satisfaction with body image, we now want to investigate how the observed association behaves as we account for gender.

```{r Multivariate Bar Plots-N, include=TRUE, fig.height=4, fig.width=7, fig.cap="Bar Plot of Perceived Mental Health and Satisfaction with Body Image by Gender."}
# Bar Plot: Multivariate Association
denoms <- c(509, 509, 638, 638, 2386, 2386, 203, 203, 405, 405, 2727, 2727)
bar.plot = ggplot(CCHS.2, aes(x = factor(Body.Image), fill = factor(Perceived.Mental.Health))) 
bar.plot = bar.plot + geom_bar(position = "dodge", aes(y = (..count..)/denoms))
bar.plot = bar.plot + labs(fill = "Perceived Mental Health")
bar.plot = bar.plot + xlab("Satisfaction with Body Image")
bar.plot = bar.plot + ylab("Conditional Proportion")
bar.plot = bar.plot + ggtitle("Perceived Mental Health and Satisfaction with Body Image by Gender")
bar.plot = bar.plot + scale_fill_manual(values = c("darkseagreen2", "plum1"))
bar.plot = bar.plot + facet_wrap(~factor(Gender), scales = "free_x")
bar.plot = bar.plot + theme_bw()
bar.plot = bar.plot + theme(plot.title = element_text(size = 11), axis.title = element_text(size = 10), legend.title = element_text(size = 10))
bar.plot
```

When studying the effect of gender of respondents in addition to satisfaction with body image, the bar plot above shows that the majority of both females and males in each level of satisfaction with body image indicated a positive perception of their mental health. Males who were satisfied with their body image had the highest proportion of positive perceived mental health. In contrast, the highest proportion of negative perceived mental health was found among females who were dissatisfied with their body image. 

```{r ThreeWay Table using janitor R Package-N, include = TRUE}
# data frame
CCHS.2 %>%                                  
  # cross-tabulate counts of two columns
  tabyl(Body.Image, Perceived.Mental.Health, Gender) %>%            
  # add a total row, add a total column
  adorn_totals(where = c("row", "col")) %>% 
  # convert to proportions with row denominator
  adorn_percentages(denominator = "row") %>% 
  # convert proportions to percents
  adorn_pct_formatting() %>%  
  # display as: "count (percent)"
  adorn_ns(position = "front") %>% 
  # adjust titles
  adorn_title(                                
    row_name = "Satisfaction with Body Image",
    col_name = "Perceived Mental Health") %>%
  # print elegant results for interactive analysis or for sharing in a report
  # e.g., with knitr::kable()
  knitr::kable(CCHS.2, format = "latex", longtable = FALSE, caption = 'Contingency Table of Perceived Mental Health and Satisfaction with Body Image by Gender') %>%
  kable_styling(latex_options = "HOLD_position")
```
\begin{center}
\textit{Note:} the top table contains female group data; the bottom table contains male group data
\end{center}

Among the female group, as satisfaction with body image increases, the conditional probabilities of positive perceived mental health increases. Specifically, 94.3% of females who were satisfied with their body image had a positive perception of their mental health, compared to 86.9% who were neither satisfied nor dissatisfied and 72.4% who were dissatisfied. Controlling for satisfaction with body image, 89.8% of females held a positive perception of their mental health.

Likewise, among the male group, as satisfaction with body image increases, the conditional probabilities of positive perceived of mental health increases. 95.6% of males who were satisfied with their body image had a positive perception of their mental health, compared to 90.3% who were neither satisfied nor dissatisfied and 75.4% who were dissatisfied. Controlling for satisfaction with body image, 93.7% of males held a positive perception of their mental health.

Overall, there is a positive correlation between positive perceived mental health and satisfaction with body image for both females and males; however, males have a stronger positive correlation than females. The distribution of perceived mental health varies by gender, for each level of satisfaction with body image. Thus, there appears to be an association between perceived mental health, satisfaction with body image and gender.

<!-- /Nevena -->

\

<!-- Abdur -->

## Satisfaction with Financial Situation, Total Household Income, and Perceived Mental Health

### Bivariate Association: Contingency Table for Mental Health and Satisfaction - Financial Situation
```{r TwoWay Table using Different R Packages-A, include = TRUE, echo = FALSE}


# Two-way Table using {janitor} package
# data frame
CCHS.2 %>%
  # cross-tabulate counts of two columns
  tabyl(Financial.Situation, Perceived.Mental.Health) %>%
  # add a total row, add a total column
  adorn_totals(where = c("row", "col")) %>%
  # convert to proportions with row denominator
  adorn_percentages(denominator = "row") %>%
  # convert proportions to percents
  adorn_pct_formatting() %>%
  # display as: "count (percent)"
  adorn_ns(position = "front") %>%
  # adjust titles
  adorn_title(
    row_name = "Satisfaction - Financial Situation",
    col_name = "Perceived Mental Health") %>%
  # print elegant results for interactive analysis or for sharing in a report
  # e.g., with knitr::kable()
  knitr::kable(CCHS.2, format = "latex", longtable= FALSE, caption = "Contingency Table of Perceived Mental Health and Satisfaction - Financial Situation") %>%
  kable_styling(latex_options = "HOLD_position")
```

Overall, we observe that 91.7% of the total 6823 respondents reported positive perceived mental health. It is observed that 78.6% of the respondents that were dissatisfied with their financial situation reported positive perceived mental health, whereas 89.8% of the individuals that were neither satisfied nor dissatisfied reported positive mental health. In addition, 95.6% of the individuals that were satisfied with their financial situation reported positive mental health.

Thus, an evident association between an individual's satisfaction with their financial situation and their perceived mental health is indicated by the above contingency table. Below, we further study the association between satisfaction with financial situation and perceived mental health using a bar plot. 




```{r Bar Plot of Data-A, include = TRUE, echo = FALSE, fig.height=4, fig.width=7, fig.cap="Bar Plots of Perceived Mental Health vs. Satisfaction - Financial Situation"}

# Perceived Mental Health and Satisfaction - Financial Situation
#bar.plot = ggplot(data = CCHS.2, aes(x = factor(Financial.Situation), fill = factor(Mental.Health)))
#bar.plot = bar.plot + geom_bar(position = "dodge")
#bar.plot = bar.plot + labs(fill = "Perceived Mental Health")
#bar.plot = bar.plot + ggtitle("Perceived Mental Health and Satisfaction - Financial Situation")
#bar.plot = bar.plot + xlab("Satisfaction - Financial Situation")  
#bar.plot = bar.plot + ylab("Count")
#bar.plot = bar.plot + scale_fill_manual(values = c("firebrick3", "cyan4"))
#bar.plot = bar.plot
#bar.plot



# proportions
denoms <- c(1131, 1131, 1232, 1232, 4460, 4460)
bar.plot1 = ggplot(data = CCHS.2, aes(x = factor(Financial.Situation), fill = factor(Perceived.Mental.Health)))
bar.plot1 = bar.plot1 + geom_bar(position = "dodge", aes(y =(..count..) / denoms))
bar.plot1 = bar.plot1 + labs(fill = "Perceived Mental Health")
bar.plot1 = bar.plot1 + labs(y  = "Conditional Proportion")
bar.plot1 = bar.plot1 + ggtitle("Perceived Mental Health and Satisfaction - Financial Situation")
# bar.plot1 = bar.plot1 + theme(axis.text.x=element_text(angle=90, hjust=1))
bar.plot1 = bar.plot1 + xlab("Satisfaction - Financial Situation")  
#bar.plot1 = bar.plot1 + scale_fill_manual(values = c("firebrick3", "cyan4"))
bar.plot1 = bar.plot1 + scale_fill_manual(values = c("slategray1", "orchid"))
bar.plot1 = bar.plot1 + theme(plot.title = element_text(size = 11), axis.title = element_text(size = 10), legend.title = element_text(size = 10))
bar.plot1
```

Observe that the highest proportion of individuals that reported negative perceived mental health was among the individuals that were dissatisfied with their financial situation, followed by the individuals that were neutral and finally, the individuals that were satisfied. However, there was a significant increase in the proportion of the individuals that reported positive perceived mental health as satisfaction with financial situation increased. 

In particular, the highest proportion of individuals that reported positive perceived mental health was among the individuals that were satisfied with their financial situation, followed by the individuals that were neutral and finally, the individuals that were dissatisfied. Conclusively, it appears that the respondents who are more satisfied with their financial situation are more likely to report positive perceived mental health.


Now, we take into account the demographic variable, total household income, and investigate the association between perceived mental health and satisfaction with financial situation across various levels of the demographic variable.


### Multivariate Association: Contingency Table for Mental Health and Satisfaction - Financial Situation by Total Household Income
```{r ThreeWay Table using janitor R Package-A, include = TRUE, echo = FALSE}
# data frame
CCHS.2 %>%
  # cross-tabulate counts of two columns
  tabyl(Financial.Situation, Perceived.Mental.Health, Total.Household.Income) %>%
  # add a total row, add a total column
  adorn_totals(where = c("row", "col")) %>%
  # convert to proportions with row denominator
  adorn_percentages(denominator = "row") %>%
  # convert proportions to percents
  adorn_pct_formatting() %>%
  # display as: "count (percent)"
  adorn_ns(position = "front") %>%
  # adjust titles
  adorn_title(
    row_name = "Satisfaction - Financial Situation",
    col_name = "Perceived Mental Health") %>%
  # print elegant results for interactive analysis or for sharing in a report
  # e.g., with knitr::kable()
  knitr::kable(CCHS.2, format = "latex", longtable= FALSE, caption = "Contingency Table for Perceived Mental Health and Satisfaction - Financial Situation by Total Household Income") %>%
  kable_styling(latex_options = "HOLD_position")
```

Notably, we observe that as the total household income increases, the total percentage of individuals that reported positive perceived mental health among the individuals that were satisfied with their financial situation increases. In particular, in the total household income $39,999 or less, 93.8% of the individuals that were satisfied with their financial situation reported positive perceived mental health. Likewise, 95.9% reported positive perceived mental health in the total household income $40,000 to $79,999 and 96.0% reported positive perceived mental health in the total household income $80,000 or more. 

Furthermore, we also observe that as the total household income increases, the total percentage of individuals that reported negative perceived mental health among the individuals that were satisfied with their financial situation decreases. In particular, in the total household income $39,999 or less, 6.2% of the individuals that were satisfied with their financial situation reported negative perceived mental health. Likewise, 4.1% reported negative perceived mental health in the total household income $40,000 to $79,999 and 4.0% reported negative perceived mental health in the total household income $80,000 or more. 


Thus, there appears to be an association between perceived mental health and financial health across the various total household incomes. Hence, we can conclude that as the total household income increases, the individuals that are more satisfied with their financial situation are more likely to report positive perceived mental health and less likely to report negative perceived mental health.



\newpage

```{r Multivariate Bar Plots-A, include=TRUE, echo = FALSE, fig.height=4, fig.width=7, fig.cap="Clustered Bar Plots of Perceived Mental Health vs. Satisfaction - Financial Situation. Letter notation: 'D': \"Dissatisfied\", 'N': \"Neutral\", 'S': \"Satisfied\""}

CCHS.2 <- CCHS.2 %>% 
  mutate(Financial.Situation = case_when(SWL_015 <= 2 ~ "S",
                                          SWL_015 == 3 ~ "N",
                                          SWL_015 >= 4 ~ "D"))

# Side-by-side Bar Plots: Multivariate Association
# bar.plot = ggplot(CCHS.2, aes(x = factor(Financial.Situation), fill = factor(Mental.Health)))
# bar.plot = bar.plot + geom_bar(position = "dodge")
# bar.plot = bar.plot + labs(fill = "Mental Health")
# bar.plot = bar.plot + xlab("Financial Situation")
# bar.plot = bar.plot + ggtitle("Bar Plots of Mental Health and Financial Situation by Total Household income")
# bar.plot = bar.plot + facet_wrap(~factor(Total.Household.Income), scales = "free_x")
# bar.plot = bar.plot + theme_bw()
# bar.plot = bar.plot + scale_fill_manual(values = c("firebrick3", "cyan4"))
# bar.plot


# proportions
denoms <- c(409, 409, 322, 322, 860, 860, 291, 291, 355, 355, 1167, 1167, 431, 431, 555, 555, 2433, 2433)
bar.plot2 = ggplot(CCHS.2, aes(x = factor(Financial.Situation), fill = factor(Perceived.Mental.Health)))
bar.plot2 = bar.plot2 + geom_bar(position = "dodge", aes(y= (..count..) / denoms))
bar.plot2 = bar.plot2 + labs(fill = "Perceived Mental Health")
bar.plot2 = bar.plot2 + labs(y = "Conditional Proportion")
bar.plot2 = bar.plot2 + xlab("Satisfaction - Financial Situation")
bar.plot2 = bar.plot2 + ggtitle("Perceived Mental Health and Satisfaction - Financial Situation by Total Household Income")
bar.plot2 = bar.plot2 + facet_wrap(~factor(Total.Household.Income), scales = "free_x")
bar.plot2 = bar.plot2 + theme_bw()
bar.plot2 = bar.plot2 + scale_fill_manual(values = c("slategray1", "orchid"))
bar.plot2 = bar.plot2 + theme(plot.title = element_text(size = 11), axis.title = element_text(size = 10), legend.title = element_text(size = 10))
bar.plot2




```



\

Similarly to the bar plots of the bivariate association between perceived mental health and satisfaction with financial situation, the bar plots taking into account total household incomes, follow a similar trend in the overall multivariate association. 

In particular, we observe that across the various levels of total household income, the highest proportion of negatively reported perceived mental health cases is among the individuals that are dissatisfied with their financial situation. That is, the individuals that are dissatisfied with their financial situation are more likely to report negative perceived mental health than those individuals that are either satisfied or neither satisfied nor dissatisfied with their financial situation.

Moreover, across each of the various levels of total household incomes, the highest proportion of individuals that reported positive perceived mental health was among the individuals that were satisfied with their financial situation, followed by the individuals that were neutral and finally, the individuals that were dissatisfied. 


Conclusively, as total household income increases, the respondents that are more satisfied with their financial situation are more likely to report positive perceived mental health and the respondents that are more dissatisfied with their financial situation are more likely to report negative perceived mental health.

<!-- /Abdur -->

\newpage

# Conclusion

In conclusion, our analysis showed that each of satisfaction with housing, body image, financial situation, relationships with friends, and oneself were connected to an individual's perception of his/her mental health.  

In reference to the statistical research questions involving total household income, it was found that as reported income increases, we see a stronger positive association between satisfaction (with either housing or financial situation) and perceived mental health.

In reference to the statistical research questions involving gender, it was found that in both female and male groups, positive mental health was positively correlated with satisfaction with body image, oneself, and relationship with friends. However, across all three satisfaction aspects, the male group exhibited a stronger positive correlation between satisfaction and positive mental health.

After having found associations between positive mental health and satisfaction with aspects of life, it is encouraged that future studies consider possible methods of improving these aspects. For example, a research question building upon our research may be: “What effect does social media have on satisfaction with oneself, in Canadian youth, accounting for current academic enrolment?” These directions for further study are not directly supported by the CCHS data set.

As mentioned earlier, the importance of mental health has become much more widely recognized, and so continuing to conduct research towards understanding what affects mental health is crucial to improving the lives of Canadians and people around the world. 

\newpage

# Appendix

### Setup:

Required Library Calls:
```{r, include = TRUE, warning = FALSE, message = FALSE, echo = TRUE, results = 'hide'}
# Load the libraries that we need to use for our statistical analysis
library(tinytex)
library(knitr)
library(tidyverse)
library(janitor)
library(mosaic)
library(patchwork)
library(kableExtra)
```

Reading CCHS data from .csv file:
```{r, message = FALSE, warning = FALSE, include = TRUE, echo = TRUE, results = 'hide'}
# Reading Data into R

# We first start by reading a data file into R.
CCHS <- read_csv("CCHS.csv")
```

Converting characters to numeric values in data:
```{r, inlcude = FALSE, warning = FALSE, echo = TRUE}
# Convert Character Variable Columns to Numeric Variables
CCHS.Num <- CCHS %>% mutate_if(is.character, as.numeric)
```

Filtering for youth and filtering out N/A responses:
```{r, include = TRUE, echo = TRUE, results = 'hide'}
## Filtering by 
## Whether or Not Attending School/College/University (1 = Yes, 2 = No)
## Age Range (2 = 15-17, 3 = 18-19, 4 = 20-24, 5 = 25-29)
CCHS.2 <- CCHS.Num %>% filter((MAC_015 == 1 | MAC_015 == 2),
                              (dhhgage > 1 & dhhgage <= 5))

## Filtering out N/A from all variables of interest.
CCHS.2 <- CCHS.2 %>% drop_na(GEN_015, SWL_015, SWL_020, SWL_025, SWL_035,
                             SWL_040, incdghh, DHH_SEX)
```

Re-leveling variables:
```{r, include = TRUE, echo = TRUE, results = 'hide'}
# Re-categorize levels

# Perceived Mental Health: 
# Positive as Excellent, Very Good, Good; Negative as Fair or Poor
CCHS.2 <- CCHS.2 %>% 
  mutate(Perceived.Mental.Health = case_when(GEN_015 <= 3 ~ "Positive", 
                                            GEN_015 >= 4 ~ "Negative"),
         Gender = case_when(DHH_SEX == 1 ~ "Male", 
                            DHH_SEX == 2 ~ "Female"),
         
         Housing.Satisfaction = case_when(SWL_040 <= 2 ~ "Satisfied",
                                          SWL_040 == 3 ~ "Neutral",
                                          SWL_040 >= 4 ~ "Dissatisfied"),
         Total.Household.Income = case_when(incdghh <= 2 ~ "$39,999 or less",
                                     incdghh == 3 | incdghh == 4 ~ "$40,000 to $79,999",
                                     incdghh == 5 ~ "$80,000 or more"),
         
         Satisfaction.with.Friends = case_when(SWL_035 <= 2 ~ "Satisfied",
                                                  SWL_035 == 3 ~ "Neutral", 
                                               SWL_035 >= 4 ~ "Dissatisfied"),
         
         Satisfaction.with.Oneself = case_when(SWL_020 <=2 ~ "Satisfied",
                                     SWL_020 <= 3  ~ "Neutral",
                                     SWL_020 <= 5 ~ "Dissatisfied"),
         
         Body.Image = case_when(SWL_025 <=2 ~ "Satisfied",
                                SWL_025 == 3 ~ "Neutral",
                                SWL_025 == 4 | SWL_025 == 5 ~ "Dissatisfied"),
         
         Financial.Situation = case_when(SWL_015 <= 2 ~ "Satisfied",
                                          SWL_015 == 3 ~ "Neutral",
                                          SWL_015 >= 4 ~ "Dissatisfied"))

Satisfaction.with.Friends.Levels <- c("Satisfied", 
                                      "Neutral", 
                                      "Dissatisfied")

Mental.Health.Levels <- c("Positive", 
                          "Negative")

CCHS.2 <- CCHS.2 %>% mutate(Satisfaction_with_Friends =
                              factor(Satisfaction.with.Friends,
                                     levels = Satisfaction.with.Friends.Levels))

CCHS.2 <- CCHS.2 %>% mutate(Mental_Health = factor(Perceived.Mental.Health,
                                                   levels = Mental.Health.Levels))
```

<!-- Lucas -->

## Analysis: Satisfaction with Housing, Total Household Income, and Perceived Mental Health

R code for Table 4:
```{r, echo = TRUE, results = 'hide'}

# Two-way Table using {janitor} package
# data frame
CCHS.2 %>%                                  
  # cross-tabulate counts of two columns
  tabyl(Housing.Satisfaction, Perceived.Mental.Health) %>%            
  # add a total row, add a total column
  adorn_totals(where = c("row", "col")) %>% 
  # convert to proportions with row denominator
  adorn_percentages(denominator = "row") %>% 
  # convert proportions to percents
  adorn_pct_formatting() %>%  
  # display as: "count (percent)"
  adorn_ns(position = "front") %>% 
  # adjust titles
  adorn_title(                                
    row_name = "Satisfaction with Housing",
    col_name = "Perceived Mental Health") %>%
  # print elegant results for interactive analysis or for sharing in a report
  # e.g., with knitr::kable()
  # knitr::kable()
  knitr::kable( CCHS.2, format = "latex", longtable = FALSE, 
                caption = 'Contingency Table of Perceived Mental Health and 
                Satisfaction with Housing. ') %>%
    kable_styling(latex_options = "HOLD_position")
```

R code for Figure 1:
```{r, echo = TRUE, eval = FALSE, results = 'hide'}
# Bar Plots of Positive Mental Health and Satisfaction with Housing
denoms <- c(298, 298, 454, 454, 6071, 6071)
bar.plot1 = ggplot(CCHS.2, aes(x = factor(Housing.Satisfaction),
                               fill = factor(Perceived.Mental.Health))) 
bar.plot1 = bar.plot1 + geom_bar(position = "dodge", aes(y = (..count..)/denoms))
bar.plot1 = bar.plot1 + labs(fill = "Perceived Mental Health")
bar.plot1 = bar.plot1 + xlab("Satisfaction with Housing")
bar.plot1 = bar.plot1 + ylab("Conditional Proportion")
bar.plot1 = bar.plot1 + scale_fill_manual(values = c("palegoldenrod", "powderblue"))
bar.plot1 = bar.plot1 + ggtitle("Perceived Mental Health and Satisfaction with Housing")
bar.plot1 = bar.plot1 + theme_bw()
bar.plot1 = bar.plot1 + theme(plot.title = element_text(size = 11),
                              axis.title = element_text(size = 10), 
                              legend.title = element_text(size = 10))

bar.plot1
```

R code for Table 5:
```{r, echo = TRUE, eval = FALSE, reuslts = 'hide'}
# data frame
CCHS.2 %>%                                  
  # cross-tabulate counts of two columns
  tabyl(Housing.Satisfaction, Perceived.Mental.Health, Total.Household.Income) %>%            
  # add a total row, add a total column
  adorn_totals(where = c("row", "col")) %>% 
  # convert to proportions with row denominator
  adorn_percentages(denominator = "row") %>% 
  # convert proportions to percents
  adorn_pct_formatting() %>%  
  # display as: "count (percent)"
  adorn_ns(position = "front") %>% 
  # adjust titles
  adorn_title(                                
    row_name = "Satisfaction with Housing",
    col_name = "Perceived Mental Health") %>%
  # print elegant results for interactive analysis or for sharing in a report
  # e.g., with knitr::kable()
  # knitr::kable()
  knitr:: kable(caption = 'Three-Way Contingency Table of Perceived Mental Health and
                Satisfaction with Housing by Total Household Income. ') %>%
    kable_styling (latex_options = "HOLD_position")
```

R code for Figure 2:
```{r, echo = TRUE, eval = FALSE, results = 'hide'}
CCHS.2 <- CCHS.2 %>% 
  mutate(Housing.Satisfaction = case_when(SWL_040 <= 2 ~ "S",
                                          SWL_040 == 3 ~ "N",
                                          SWL_040 >= 4 ~ "D"))

# Side-by-side Bar Plots: Multivariate Association
denoms <- c(128, 128, 150, 150, 1313, 1313, 95, 95, 147, 147, 1571, 1571, 75,
            75, 157, 157, 3187, 3187)
bar.plot = ggplot(CCHS.2, aes(x = factor(Housing.Satisfaction),
                              fill = factor(Perceived.Mental.Health))) 
bar.plot = bar.plot + geom_bar(position = "dodge", aes(y = (..count..)/denoms))
bar.plot = bar.plot + labs(fill = "Perceived Mental Health")
bar.plot = bar.plot + xlab("Satisfaction with Housing")
bar.plot = bar.plot + ylab("Conditional Proportion")
bar.plot = bar.plot + scale_fill_manual(values = c("palegoldenrod", "powderblue"))
bar.plot = bar.plot + ggtitle("Perceived Mental Health and Satisfaction by Income")
bar.plot = bar.plot + facet_wrap(~factor(Total.Household.Income), scales = "free_x")
bar.plot = bar.plot + theme_bw()
bar.plot = bar.plot + theme(plot.title = element_text(size = 11),
                            axis.title = element_text(size = 10),
                            legend.title = element_text(size = 10))
bar.plot
```

<!-- /Lucas -->

<!-- Keshav -->

## Analysis: Satisfaction with Relationships with Friends, Gender, and Perceived Mental Health

R code for Figure 3
```{r, echo=TRUE, eval=FALSE, results='hide'}
denoms <- c(6262, 6262, 328, 328, 190, 190)
bar.plot = ggplot(data = CCHS.2, aes(x = Satisfaction_with_Friends,
                                     fill = factor(Mental_Health)))
bar.plot = bar.plot + geom_bar(position = "dodge", 
                               aes(y =(..count..)/ denoms))
bar.plot = bar.plot + ggtitle("Perceived Mental Health vs. Satisfaction -
                              Relationships with Friends")
bar.plot = bar.plot + theme(axis.text.x=element_text(angle=90, hjust=1))
bar.plot = bar.plot + xlab("Satisfaction - Relationships with Friends")  
bar.plot = bar.plot + ylab("Conditional Proportion")
bar.plot = bar.plot + labs(fill="Perceived Mental Health")
bar.plot = bar.plot + theme_bw()
bar.plot = bar.plot + theme(plot.title = element_text(size = 11),
                            axis.title = element_text(size = 10),
                            legend.title = element_text(size = 10))
# Colour
bar.plot = bar.plot + scale_fill_manual(values = c("mediumaquamarine", "rosybrown1"))
bar.plot
```

R code for Table 6
```{r, echo=TRUE, eval=FALSE, results='hide'}
CCHS.2 %>%                                    # data frame
  # cross-tabulate counts of two columns
  tabyl(Satisfaction_with_Friends, Mental_Health) %>%
  adorn_totals(where = c("row", "col")) %>%   # add a total row, add a total column
  # convert to proportions with row denominator
  adorn_percentages(denominator = "row") %>%
  adorn_pct_formatting() %>%                  # convert proportions to percents
  adorn_ns(position = "front") %>%            # display as: "count (percent)"
  adorn_title(                                # adjust titles
    row_name = "Satisfaction - Relationships with Friends",
    col_name = "Perceived Mental Health") %>%
knitr::kable( CCHS.2, format = "latex",longtable = FALSE,
              caption = 'Contingency Table of Perceived Mental Health and Satisfaction
              - Relationships with Friends.') %>%
  kable_styling(latex_options = "HOLD_position")
```

R code for Figure 4
```{r, echo=TRUE, eval=FALSE, results='hide'}
denoms <- c(3187, 3187, 194, 194, 108, 108, 3075, 3075, 134, 134, 82, 82)
bar.plot = ggplot(CCHS.2, aes(x = Satisfaction_with_Friends,
                              fill = factor(Mental_Health)))
bar.plot = bar.plot + geom_bar(position = "dodge", 
                               aes(y =(..count..)/denoms))
bar.plot = bar.plot + labs(fill = "Perceived Mental Health")
bar.plot = bar.plot + xlab("Satisfaction - Relationships with Friends") 
bar.plot = bar.plot + ylab("Conditional Proportion")
bar.plot = bar.plot + ggtitle("Perceived Mental Health vs. Satisfaction -
                              Relationships with Friends \n by Gender")
bar.plot = bar.plot + theme_bw()
bar.plot = bar.plot + theme(plot.title = element_text(size = 11),
                            axis.title = element_text(size = 10),
                            legend.title = element_text(size = 10))
bar.plot = bar.plot + facet_wrap(~Gender, scales = "free_x")
# Colour
bar.plot = bar.plot + scale_fill_manual(values = c("mediumaquamarine", "rosybrown1"))
bar.plot
```

R code for Table 7
```{r, echo=TRUE, eval=FALSE, results='hide'}
CCHS.2 %>%                                    # data frame
  # cross-tabulate counts of two columns
  tabyl(Satisfaction_with_Friends, Mental_Health, Gender) %>%
  adorn_totals(where = c("row", "col")) %>%   # add a total row, add a total column
  # convert to proportions with row denominator
  adorn_percentages(denominator = "row") %>%
  adorn_pct_formatting() %>%                  # convert proportions to percents
  adorn_ns(position = "front") %>%            # display as: "count (percent)"
  adorn_title(                                # adjust titles
    row_name = "Satisfaction - Relationships with Friends",
    col_name = "Perceived Mental Health") %>%
knitr::kable(caption = 'Partial Two-Way Table of Perceived Mental Health and Satisfaction
             - Relationships with Friends, by Gender.') %>%
  kable_styling(latex_options = "HOLD_position") %>%
    footnote(general = "The top table contains female group data, the bottom table
             contains male group data")
```

<!-- /Keshav -->

<!-- Jacky -->

## Analysis: Satisfaction with Oneself, Gender, and Perceived Mental Health

R code for Figure 5:
```{r , echo=TRUE, eval=FALSE, results='hide'}
# Bar Plots of Positive Mental Health and Satisfaction with Oneself
denoms <- c(287, 287, 575, 575, 5961, 5961)
bar.plot1 = ggplot(CCHS.2, aes(x = factor(Satisfaction.with.Oneself),
                               fill = factor(Perceived.Mental.Health))) 
bar.plot1 = bar.plot1 + geom_bar(position = "dodge", aes(y =(..count..)/denoms))
bar.plot1 = bar.plot1 + ggtitle("Perceived Mental Health vs. Satisfaction - with Onself")
bar.plot1 = bar.plot1 + labs(fill = "Perceived Mental Health")
bar.plot1 = bar.plot1 + xlab("Satisfaction with Oneself") 
bar.plot1 = bar.plot1 + ylab("Conditional Proportion")
bar.plot1 = bar.plot1 + theme_bw()
bar.plot = bar.plot + theme(plot.title = element_text(size = 11),
                            axis.title = element_text(size = 10),
                            legend.title = element_text(size = 10))
bar.plot = bar.plot + scale_fill_manual(values = c("darkolivegreen3", "lightsalmon"))
bar.plot1
```

R code for Table 8:
```{r , echo=TRUE, eval=FALSE, results='hide'}
# Two-way Table using {janitor} package
# data frame
CCHS.2 %>%                                  
  # cross-tabulate counts of two columns
  tabyl(Satisfaction.with.Oneself, Perceived.Mental.Health) %>%            
  # add a total row, add a total column
  adorn_totals(where = c("row", "col")) %>% 
  # convert to proportions with row denominator
  adorn_percentages(denominator = "row") %>% 
  # convert proportions to percents
  adorn_pct_formatting() %>%  
  # display as: "count (percent)"
  adorn_ns(position = "front") %>% 
  # adjust titles
  adorn_title(                                
    row_name = "Satisfaction with Oneself",
    col_name = "Perceived Mental Health") %>%
  # print elegant results for interactive analysis or for sharing in a report
  # e.g., with knitr::kable() %>%
  knitr::kable(CCHS.2, format = "latex", longtable = FALSE,
               caption = 'Contingency Table of Perceived Mental Health and
               Satisfaction with Oneself') %>% 
  kable_styling(latex_options = "HOLD_position")
```

R code for Figure 6:
```{r , echo=TRUE, eval=FALSE, results='hide'}
denoms <- c(160, 160, 357, 357, 2993, 2993, 127, 127, 218, 218, 2968, 2968)
# Side-by-side Bar Plots: Multivariate Association
bar.plot = ggplot(CCHS.2, aes(x = Satisfaction.with.Oneself,
                              fill = factor(Perceived.Mental.Health))) 
bar.plot = bar.plot + geom_bar(position = "dodge", aes(y =(..count..)/denoms))
bar.plot = bar.plot + labs(fill = "Perceived Mental Health")
bar.plot = bar.plot + xlab("Satisfaction with Oneself")
bar.plot = bar.plot + ylab("Conditional Proportion")
bar.plot = bar.plot + ggtitle("Perceived Mental Health vs. Satisfaction with Oneself by
                              Gender")
bar.plot = bar.plot + facet_wrap(~factor(Gender), scales = "free_x")
bar.plot = bar.plot + theme_bw()
bar.plot = bar.plot + theme(plot.title = element_text(size = 11),
                            axis.title = element_text(size = 10),
                            legend.title = element_text(size = 10))
bar.plot = bar.plot + scale_fill_manual(values = c("darkolivegreen3", "lightsalmon"))
bar.plot
```

R code for Table 9:
```{r , echo=TRUE, eval=FALSE, results='hide'}
# data frame
CCHS.2 %>%                                  
  # cross-tabulate counts of two columns
  tabyl(Satisfaction.with.Oneself, Perceived.Mental.Health, Gender) %>%            
  # add a total row, add a total column
  adorn_totals(where = c("row", "col")) %>% 
  # convert to proportions with row denominator
  adorn_percentages(denominator = "row") %>% 
  # convert proportions to percents
  adorn_pct_formatting() %>%  
  # display as: "count (percent)"
  adorn_ns(position = "front") %>% 
  # adjust titles
  adorn_title(                                
    row_name = "Satisfaction with Oneself",
    col_name = "Perceived Mental Health") %>%
  # print elegant results for interactive analysis or for sharing in a report
  # e.g., with knitr::kable()
  knitr::kable(CCHS.2, format = "latex", longtable = FALSE,
               caption = 'ContingencyTable of Perceived Mental Health and
               Satisfaction with Oneself by Gender') %>% 
  kable_styling(latex_options = "HOLD_position")
```


<!-- /Jacky -->

<!-- Nevena -->

## Analysis: Satisfaction with Body Image, Gender, and Perceived Mental Health

R code for Figure 7:
```{r, echo = TRUE, eval = FALSE, results = 'hide'}
# Bar Plot of Satisfaction with Body Image and Positive Mental Health
denoms <- c(712, 712, 1043, 1043, 5113, 5113)
bar.plot1 = ggplot(CCHS.2, aes(x = factor(Body.Image),
                               fill = factor(Perceived.Mental.Health))) 
bar.plot1 = bar.plot1 + geom_bar(position = "dodge", aes(y = (..count..)/denoms))
bar.plot1 = bar.plot1 + labs(fill = "Perceived Mental Health")
bar.plot1 = bar.plot1 + xlab("Satisfaction with Body Image") 
bar.plot1 = bar.plot1 + ylab("Conditional Proportion")
bar.plot1 = bar.plot1 + scale_fill_manual(values = c("darkseagreen2", "plum1"))
bar.plot1 = bar.plot1 + ggtitle("Perceived Mental Health and Satisfaction with
                                Body Image")
bar.plot1 = bar.plot1 + theme(plot.title = element_text(size = 11),
                              axis.title = element_text(size = 10),
                              legend.title = element_text(size = 10))
bar.plot1
```

R code for Table 10:
```{r echo = TRUE, eval = FALSE, results = 'hide'}
# Two-way Table using {janitor} package
# data frame
CCHS.2 %>%                                  
  # cross-tabulate counts of two columns
  tabyl(Body.Image, Perceived.Mental.Health) %>%            
  # add a total row, add a total column
  adorn_totals(where = c("row", "col")) %>% 
  # convert to proportions with row denominator
  adorn_percentages(denominator = "row") %>% 
  # convert proportions to percents
  adorn_pct_formatting() %>%  
  # display as: "count (percent)"
  adorn_ns(position = "front") %>% 
  # adjust titles
  adorn_title(                                
    row_name = "Satisfation with Body Image",
    col_name = "Perceived Mental Health") %>%
  # print elegant results for interactive analysis or for sharing in a report
  # e.g., with knitr::kable()
  knitr::kable(CCHS.2, format = "latex", longtable = FALSE, 
               caption = 'Contingency Table of Perceived Mental Health 
               and Satisfaction with Body Image') %>%
  kable_styling(latex_options = "HOLD_position")
```

R code for Figure 8:
```{r echo = TRUE, eval = FALSE, results = 'hide'}
# Bar Plot: Multivariate Association
denoms <- c(509, 509, 638, 638, 2386, 2386, 203, 203, 405, 405, 2727, 2727)
bar.plot = ggplot(CCHS.2, aes(x = factor(Body.Image),
                              fill = factor(Perceived.Mental.Health))) 
bar.plot = bar.plot + geom_bar(position = "dodge", aes(y = (..count..)/denoms))
bar.plot = bar.plot + labs(fill = "Perceived Mental Health")
bar.plot = bar.plot + xlab("Satisfaction with Body Image")
bar.plot = bar.plot + ylab("Conditional Proportion")
bar.plot = bar.plot + ggtitle("Perceived Mental Health and Satisfaction with 
                              Body Image by Gender")
bar.plot = bar.plot + scale_fill_manual(values = c("darkseagreen2", "plum1"))
bar.plot = bar.plot + facet_wrap(~factor(Gender), scales = "free_x")
bar.plot = bar.plot + theme_bw()
bar.plot = bar.plot + theme(plot.title = element_text(size = 11), 
                            axis.title = element_text(size = 10), 
                            legend.title = element_text(size = 10))
bar.plot
```

R code for Table 11:
```{r echo = TRUE, eval = FALSE, results = 'hide'}
# data frame
CCHS.2 %>%                                  
  # cross-tabulate counts of two columns
  tabyl(Body.Image, Perceived.Mental.Health, Gender) %>%            
  # add a total row, add a total column
  adorn_totals(where = c("row", "col")) %>% 
  # convert to proportions with row denominator
  adorn_percentages(denominator = "row") %>% 
  # convert proportions to percents
  adorn_pct_formatting() %>%  
  # display as: "count (percent)"
  adorn_ns(position = "front") %>% 
  # adjust titles
  adorn_title(                                
    row_name = "Satisfaction with Body Image",
    col_name = "Perceived Mental Health") %>%
  # print elegant results for interactive analysis or for sharing in a report
  # e.g., with knitr::kable()
  knitr::kable(CCHS.2, format = "latex", longtable = FALSE, 
               caption = 'Contingency Table of Perceived Mental Health 
               and Satisfaction with Body Image by Gender') %>%
  kable_styling(latex_options = "HOLD_position")
```

<!-- /Nevena -->

<!-- Abdur -->

R code for Table 12:
```{r Two-Way Table using Different R Packages-AA, echo  = TRUE, eval = FALSE, results = 'hide'}
# Two-way Table using {janitor} package
# data frame
CCHS.2 %>%
  # cross-tabulate counts of two columns
  tabyl(Financial.Situation, Perceived.Mental.Health) %>%
  # add a total row, add a total column
  adorn_totals(where = c("row", "col")) %>%
  # convert to proportions with row denominator
  adorn_percentages(denominator = "row") %>%
  # convert proportions to percents
  adorn_pct_formatting() %>%
  # display as: "count (percent)"
  adorn_ns(position = "front") %>%
  # adjust titles
  adorn_title(
    row_name = "Satisfaction - Financial Situation",
    col_name = "Perceived Mental Health") %>%
  # print elegant results for interactive analysis or for sharing in a report
  # e.g., with knitr::kable()
  knitr::kable(CCHS.2, format = "latex", longtable= FALSE, caption = "Contingency Table
               of Perceived Mental Health and Satisfaction - Financial Situation") %>%
  kable_styling(latex_options = "HOLD_position")
```


R code for Figure 9:
```{r, echo  = TRUE, eval = FALSE, results = 'hide'}
denoms <- c(1131, 1131, 1232, 1232, 4460, 4460)
bar.plot1 = ggplot(data = CCHS.2, aes(x = factor(Financial.Situation), 
                                      fill = factor(Perceived.Mental.Health)))
bar.plot1 = bar.plot1 + geom_bar(position = "dodge", aes(y =(..count..) / denoms))
bar.plot1 = bar.plot1 + labs(fill = "Perceived Mental Health")
bar.plot1 = bar.plot1 + labs(y  = "Conditional Proportion")
bar.plot1 = bar.plot1 + ggtitle("PerceivedMental Health and Satisfaction - Financial
                                Situation")
# bar.plot1 = bar.plot1 + theme(axis.text.x=element_text(angle=90, hjust=1))
bar.plot1 = bar.plot1 + xlab("Satisfaction - Financial Situation")  
bar.plot1 = bar.plot1 + scale_fill_manual(values = c("slategray1", "orchid"))
bar.plot1 = bar.plot1 + theme(plot.title = element_text(size = 11), axis.title = 
                                element_text(size = 10), legend.title = 
                                element_text(size = 10))
bar.plot1
```

R code for Table 13:
```{r Three-Way Table using janitor R Package-AA, echo  = TRUE, eval = FALSE, results = 'hide'}
# data frame
CCHS.2 %>%
  # cross-tabulate counts of two columns
  tabyl(Financial.Situation, Perceived.Mental.Health, Total.Household.Income) %>%
  # add a total row, add a total column
  adorn_totals(where = c("row", "col")) %>%
  # convert to proportions with row denominator
  adorn_percentages(denominator = "row") %>%
  # convert proportions to percents
  adorn_pct_formatting() %>%
  # display as: "count (percent)"
  adorn_ns(position = "front") %>%
  # adjust titles
  adorn_title(
    row_name = "Satisfaction - Financial Situation",
    col_name = "Perceived Mental Health") %>%
  # print elegant results for interactive analysis or for sharing in a report
  # e.g., with knitr::kable()
  knitr::kable(CCHS.2, format = "latex", longtable= FALSE, caption = 
                 "Contingency Table for Perceived Mental Health and Satisfaction - 
               Financial Situation by Total Household Income") %>%
  kable_styling(latex_options = "HOLD_position")
```


R code for Figure 10:
```{r Multi-variate Bar Plots-AA, echo  = TRUE, eval = FALSE, results = 'hide'}

CCHS.2 <- CCHS.2 %>% 
  mutate(Financial.Situation = case_when(SWL_015 <= 2 ~ "S",
                                          SWL_015 == 3 ~ "N",
                                          SWL_015 >= 4 ~ "D"))

# Side-by-side Bar Plots: Multivariate Association
denoms <- c(409, 409, 322, 322, 860, 860, 291, 291, 355, 355, 1167, 1167, 431, 431, 555,
            555, 2433, 2433)
bar.plot2 = ggplot(CCHS.2, aes(x = factor(Financial.Situation), fill = 
                                 factor(Perceived.Mental.Health)))
bar.plot2 = bar.plot2 + geom_bar(position = "dodge", aes(y= (..count..) / 
                                                           denoms))
bar.plot2 = bar.plot2 + labs(fill = "Perceived Mental Health")
bar.plot2 = bar.plot2 + labs(y = "Conditional Proportion")
bar.plot2 = bar.plot2 + xlab("Satisfaction - Financial Situation")
bar.plot2 = bar.plot2 + ggtitle("Percieved Mental Health and Satisfaction - Financial 
                                Situation by Total Household Income")
bar.plot2 = bar.plot2 + facet_wrap(~factor(Total.Household.Income), scales = 
                                     "free_x")
bar.plot2 = bar.plot2 + theme_bw()
bar.plot2 = bar.plot2 + scale_fill_manual(values = c("slategray1", "orchid"))
bar.plot2 = bar.plot2 + theme(plot.title = element_text(size = 11), axis.title = 
                                element_text(size = 10), legend.title = 
                                element_text(size = 10))
bar.plot2

```

